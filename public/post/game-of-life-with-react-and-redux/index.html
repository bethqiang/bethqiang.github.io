<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Game of Life with React and Redux: The Hard Parts &middot; Beth Qiang</title>
  <meta name="author" content="Beth Qiang">
  <meta name="description" content="A developer&#39;s thoughts on life, code, and the pursuit of happiness.">
  <meta name="generator" content="Hugo 0.18.1" />
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <!-- RSS autodiscovery -->
  

  <link rel="shortcut icon" href="http://bethqiang.com/img/favicon.ico">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="http://bethqiang.com/css/main.css">
  <link rel="stylesheet" href="http://bethqiang.com/css/github.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css">

  

  <!-- Stylesheet for theme color -->
  <style type="text/css">
  a {color: #3498db;}
  .pagination a {color: #3498db;}
  .gist .gist-file .gist-meta {color: #3498db !important;}
  a:focus, a:hover {color: #2079b4;}
  h1.post-title a:focus, h1.post-title a:hover, h1.blog-title a:focus, h1.blog-title a:hover {color: #2079b4;}
  .older-posts:hover, .newer-posts:hover {color: #2079b4;}
</style>
</head>

<body class="home-template">
  <div class="site-header">
  <nav class="site-nav">
    <a href="#" id="menu-icon" class="menu-icon">
      <svg viewBox="0 0 18 15">
        <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"
        />
        <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"
        />
        <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"
        />
      </svg>
    </a>

    <div class="trigger">
      <div class="social">
        
          <a href="//twitter.com/bethqiang" target="_blank" title="Twitter" class="contact-icon"><i class="fa fa-twitter"></i></a>
        
        
          <a href="//github.com/bethqiang" target="_blank" title="GitHub" class="contact-icon"><i class="fa fa-github"></i></a>
        
        
          <a href="//www.linkedin.com/in/bethanyqiang" target="_blank" title="linkedIn" class="contact-icon"><i class="fa fa-linkedin"></i></a>
        
        
          <a href="mailto:you@example.com" target="_blank" title="Email" class="contact-icon"><i class="fa fa-envelope"></i></a>
        
        
      </div>

      <div class="main-nav">
        <a href="http://bethqiang.com/" class="page-link">Blog</a>
        
          <a href="about/" class="page-link">About</a>
        
          <a href="portfolio/" class="page-link">Portfolio</a>
        
      </div>
    </div>
  </nav>
</div>


  <main class="content" role="main">
    
  <article class="post">
    <header>
      <h1 class="post-title">Game of Life with React and Redux: The Hard Parts</h1>
      <div class="post-meta">
        
          <time datetime="December 22, 2016">
            December 22, 2016
          </time>
        
      </div>
    </header>

    <section class="post-content">
      

<p>For the past few days, I&rsquo;ve spent most of my time slowly cobbling together the Game of Life using React, Redux, and Sass. There&rsquo;s actually really not that much Sass – starting out, I wanted to practice it, although now that I&rsquo;m halfway through, I&rsquo;m realizing that I really don&rsquo;t need it. I probably should have just saved it for another project – but anyway.</p>

<p>In the <a href="http://bethqiang.com/post/game-of-life-and-introductory-nodejs/" target="_blank">first week of Fullstack</a>, we actually built Game of Life with vanilla JavaScript. My pair and I fought through some battles together, and so I anticipated that re-doing it using a few extra technologies wasn&rsquo;t going to be <em>that</em> hard. (Famous last words.)</p>

<h2 id="the-webpack-rabbit-hole">The Webpack Rabbit Hole</h2>

<p>The first roadblock I ran into was trying to run and deploy a front-end-only React app via GitHub Pages. (I didn&rsquo;t want to bother with any kind of back-end, even a little mini server to serve static files, because I recently discovered that Heroku makes you give them your credit card information if you want to deploy more than five apps. Which is fine, and I&rsquo;m sure I&rsquo;ll do it eventually, but if I can avoid it, I totally will.) So, I couldn&rsquo;t serve static files. Which meant that my main <code>index.html</code> file had to be in my root directory. Okay, that&rsquo;s annoying, but that&rsquo;s not <em>too</em> bad. (Yet.)</p>

<p>After pondering a couple of different possibilities, including just linking CDNs to React and Redux in the index.html, I decided to go the Webpack route. I&rsquo;d then be able to throw Sass into the mixture. I set up a basic version of Webpack, along with React and Redux, coded a quick &ldquo;Hello World,&rdquo; and deployed it under a repo titled &ldquo;experiment.&rdquo; I told Webpack to output my <code>bundle.js</code> in a <code>public</code> folder. And&hellip;then I realized I had no idea how to open my app locally.</p>

<p>As a result, I ended up diving into and spending hours in a Webpack rabbit hole learning how to set up the Webpack dev server and a production Webpack configuration. Webpack can do <em>a lot</em> of things, and I&rsquo;m sure I didn&rsquo;t even come across half of them. After a few more rounds of experimentally uploading and deploying, I finally settled on a configuration that would deploy without errors, and had a colorful &ldquo;Hello World!&rdquo; to prove it!</p>

<p>So, that was a fun day 1 of this project.</p>

<h2 id="the-beginning-aka-the-starting-grid">The Beginning (aka, the Starting Grid)</h2>

<p>My next major hurdle came when I started adding files I thought I&rsquo;d need (action creators, reducers, components, containers, etc.). I started by trying to create rough outlines of the components, and then I&rsquo;d think about everything I&rsquo;d need the component&rsquo;s containers to do, and then I tried writing functions in containers, and then I forgot entirely how Redux worked, and then I got really overwhelmed.</p>

<p>So. Deep breath.</p>

<p>I deleted my rough outlines in attempt to start from a clean slate. I started again, this time with the <em>sole goal</em> of just getting some kind of grid to show up. I wasn&rsquo;t sure where to put this magical <code>makeGrid</code> function, and stuck it in a <code>utils.js</code> file for the moment, figuring I could move it later. I needed to represent the board&rsquo;s cells and their status in some way. I made a giant array of objects, each of which would have properties like an <code>id</code> and a <code>status</code>, which is what my pair and I did when we did this in vanilla JavaScript.</p>

<pre><code>export const makeGrid = (width, height) =&gt; {
  let grid = [];
  for (let yCoord = 0; yCoord &lt; width; yCoord++) {
    for (let xCoord = 0; xCoord &lt; height; xCoord++) {
      grid.push({
        xCoord,
        yCoord,
        status: 'dead'
      })
    }
  }
  return grid;
}
</code></pre>

<p>When I passed this through the <code>BoardContainer</code> down to the <code>Board</code> component, I didn&rsquo;t see a way I could easily map over the array in a way that would give me a board with a certain number of rows and columns, instead of a board that consisted of one row with many, many columns. I revisited my <code>makeGrid</code> function and instead, made an array that had rows that were also arrays that held objects, that were each of the individual cells.</p>

<pre><code>export const makeGrid = (height, width) =&gt; {
  let grid = [];
  for (let yCoord = 0; yCoord &lt; height; yCoord++) {
    let row = [];
    for (let xCoord = 0; xCoord &lt; width; xCoord++) {
      row.push({
        xCoord,
        yCoord,
        status: 'dead'
      });
    }
    grid.push(row);
  }
  return grid;
};
</code></pre>

<p>I wanted the <code>yCoord</code> to refer to the vertical axes and the <code>xCoord</code> to refer to the horizontal axes, as that seemed like the most intuitive path to me. Little did I know that this would cause me a slight headache later. Anyway, in my <code>Board</code> component, I could map over each row, and within each row, map over each cell, like so:</p>

<pre><code>const Board = props =&gt; {
  return (
    &lt;div&gt;
      &lt;table&gt;
        &lt;tbody&gt;
          {props.board.grid.map((row, yCoord) =&gt; (
            &lt;tr key={yCoord}&gt;
              {row.map((cell, xCoord) =&gt; (
                &lt;Cell key={xCoord}
                  id={props.id}
                  status={props.board.grid[xCoord][yCoord].status}
                  handleClick={() =&gt; props.toggleCell(xCoord, yCoord)} /&gt;
              ))}
            &lt;/tr&gt;
          ))}
        &lt;/tbody&gt;
      &lt;/table&gt;
    &lt;/div&gt;
  );
};
</code></pre>

<p>I then set up a very basic cell component, added in some styling, and voila, I had a grid!</p>

<p>Making the board have a random configuration upon the initial render wasn&rsquo;t difficult; I just added a <code>randomize</code> parameter with a default value of <code>true</code> to the <code>makeGrid</code> function and a conditional:</p>

<pre><code>if (randomize) {
  if (Math.random() &gt; 0.75) status = 'alive';
  else status = 'dead';
}
</code></pre>

<h2 id="counting-living-neighbors">Counting Living Neighbors</h2>

<p>Cool! Next goal: advance to the next generation, given the number of dead or alive neighbors around each cell.</p>

<p>After creating actions, I needed to create a new function that would &ldquo;calculate&rdquo; the new statuses of each cell. This ended up looking like this:</p>

<pre><code>export const stepForward = (grid = []) =&gt; {

  const height = grid.length;
  const width = grid[0].length;
  const newGrid = [];
  let status;

  for (let yCoord = 0; yCoord &lt; height; yCoord++) {
    let newRow = [];
    for (let xCoord = 0; xCoord &lt; width; xCoord++) {
      let currStatus = grid[xCoord][yCoord].status;
      let count = getLivingNeighbors(xCoord, yCoord, grid);
      if (currStatus === 'alive' &amp;&amp; (count === 2 || count === 3)) {
        status = 'alive';
      } else if (currStatus === 'dead' &amp;&amp; count === 3) {
        status = 'alive';
      } else {
        status = 'dead';
      }
      newRow.push({
        xCoord,
        yCoord,
        status
      });
    }
    newGrid.push(newRow);
  }
  return newGrid;
};
</code></pre>

<p>Yes, there&rsquo;s a lot of repetition in there&hellip;I&rsquo;m essentially recreating the <code>makeGrid</code> function, with some extra stuff in between. Refactoring these huge functions is definitely on the to-do list.</p>

<p><code>getLivingNeighbors</code> was a function that consisted of nested <code>for</code> loops, to loop through each cell that surrounded the current cell, checked if the <code>className</code> on the cell DOM element was <code>'alive'</code>, and if so, incremented the <code>count</code>.
I was quite proud of myself for figuring out all of this, and ran my code&hellip;only to realize that all of the cells would immediately die on the first &ldquo;step.&rdquo; After puzzling and Googling, it turns out, <code>document.getElementById</code> doesn&rsquo;t work in React – you can&rsquo;t directly manipulate the DOM! Well, that&rsquo;s something. A few Stack Overflow answers suggested trying the <code>ref</code> property that React provides, but even though it was a possibility, it didn&rsquo;t seem like what the <code>ref</code> property was intended for. (I didn&rsquo;t have a callback function to provide within it; I just wanted to access the DOM element&hellip;)</p>

<p>Instead, I took a somewhat roundabout way of getting the surrounding cells and their status. To make this work, I also had to change the values of the <code>status</code> field from <code>'alive'</code> or <code>'dead'</code> to 1s and 0s so that I could just increment the count based on neighboring statuses instead of trying to deal with conditionals for each neighbor.</p>

<pre><code>const getLivingNeighbors = (xCoord, yCoord, grid = []) =&gt; {

  const height = grid.length;
  const width = grid[0].length;

  // If a cell is at the edge of the grid, the cell on the opposite edge will be its neighbor
  const left = xCoord - 1 &lt; 0 ? (width - 1) : (xCoord - 1);
  const right = xCoord + 1 === width ? 0 : (xCoord + 1);
  const up = yCoord - 1 &lt; 0 ? (height - 1) : (yCoord - 1);
  const down = yCoord + 1 === height ? 0 : (yCoord + 1);

  let count = 0;

  count += grid[left][up].status;
  count += grid[xCoord][up].status;
  count += grid[right][up].status;
  count += grid[left][yCoord].status;
  count += grid[right][yCoord].status;
  count += grid[left][down].status;
  count += grid[xCoord][down].status;
  count += grid[right][down].status;

  return count;
};
</code></pre>

<h2 id="non-intuitive-grid-positioning">Non-Intuitive Grid Positioning</h2>

<p>So, remember when I said, &ldquo;I wanted the <code>yCoord</code> to refer to the vertical axes and the <code>xCoord</code> to refer to the horizontal axes, as that seemed like the most intuitive path to me. Little did I know that this would cause me a slight headache later.&rdquo;</p>

<p>Well, once I had the <code>stepForward</code> function coded out and triggering with a click on the corresponding button, I discovered that though my Game of Life was doing <em>something</em> in the next generation, the common patterns weren&rsquo;t behaving quite as expected. (Although, they weren&rsquo;t disappearing, at least.)</p>

<p>After a lot of state-examining (thanks, <code>redux-logger</code>!) and clicking around on boxes, I discovered that there was a conflict between the way I had set up my grid and the way I was referencing positions in it. Because I set it up so that each row is its own array and the rows were the y coordinates, this actually meant that whenever I wanted to reference a position on the grid, I&rsquo;d have to specify the y coordinate first. (e.g. <code>grid[y][x]</code> – until this point, I had been doing the opposite.)</p>

<p>After changing this in every place I was referencing a grid position, everything worked as expected! I could now advance generations on the click of a button, as well as click to toggle a cell to be <code>alive</code> or <code>dead</code>.</p>

<h2 id="next-steps">Next Steps</h2>

<p>Now that I have at least the basic core functionality down of moving from generation to generation, I have a couple of smaller things to add:</p>

<ul>
<li>A <code>setInterval</code> or <code>requestAnimationFrame</code> so that the game will automatically advance generations on initial render or on the press of the play button</li>
<li>A counter to show the number of generations that have passed</li>
<li>Functionality of the rest of the buttons (play, stop, random)</li>
<li>Some styling and pretty colors</li>
</ul>

<p>Possibly one the more intensive and time-consuming things will be refactoring – right now, most of my core functionality is in a massive <code>utils.js</code> file with two large and repetitive functions. It&rsquo;d be nice to see if I could also make it so that when I&rsquo;m referencing positions in the grid, I can specify the x coordinate first instead of the y.</p>

<p>In case you&rsquo;re curious, <a href="https://github.com/bethqiang/game-of-life" target="_blank">here&rsquo;s</a> the GitHub repo for this project. It&rsquo;s not deployed yet, but I do plan on it after I&rsquo;m done!</p>

    </section>

    
      <section class="post-tags" style="padding-bottom:60px;">
        <div class="post-meta tags">
          <i class="fa fa-fw fa-tag"></i>
          
            
            <a href="http://bethqiang.com/tags/react" class="tag-comma-separate">react</a>
          
            
            <a href="http://bethqiang.com/tags/redux" class="tag-comma-separate">redux</a>
          
            
            <a href="http://bethqiang.com/tags/game-of-life" class="tag-comma-separate">game of life</a>
          
        </div>
      </section>

      <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'bethqiang';
    var disqus_identifier = 'http:\/\/bethqiang.com\/post\/game-of-life-with-react-and-redux\/';
    var disqus_title = 'Game of Life with React and Redux: The Hard Parts';
    var disqus_url = 'http:\/\/bethqiang.com\/post\/game-of-life-with-react-and-redux\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      <section class="share">
  <p class="info prompt">Share</p>
  <a href="http://twitter.com/share?text=Game%20of%20Life%20with%20React%20and%20Redux%3a%20The%20Hard%20Parts&url=http%3a%2f%2fbethqiang.com%2fpost%2fgame-of-life-with-react-and-redux%2f" title="Share on Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
    <i class="fa fa-2x fa-fw fa-twitter-square"></i> <span class="hidden">Twitter</span>
  </a>
  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fbethqiang.com%2fpost%2fgame-of-life-with-react-and-redux%2f" title="Share on Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
    <i class="fa fa-2x fa-fw fa-facebook-square" style="margin-left: -8px"></i> <span class="hidden">Facebook</span>
  </a>
  <a href="https://plus.google.com/share?url=http%3a%2f%2fbethqiang.com%2fpost%2fgame-of-life-with-react-and-redux%2f" title="Share on Google+" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
    <i class="fa fa-2x fa-fw fa-google-plus-square" style="margin-left: -8px"></i> <span class="hidden">Google+</span>
  </a>
</section>

      <footer class="post-footer">
        <section class="author">
  <div class="authorimage" style="background: url(http://bethqiang.com/img/avatar.jpg)"></div>
  <h4>Beth Qiang</h4>
  <p class="bio">developer - runner - animal lover - food enthusiast</p>
  <p class="meta">
    <i class="fa fa-fw fa-map-marker"></i> Austin, TX
  </p>
</section>
      </footer>
    
  </article>

  </main>

  <a href="javascript:">
  <div id="back-to-top">
    <p class="backtotop">
      <i class="fa fa-lg fa-angle-double-up"></i>
      <a class="backtotoptext">Back to top</a>
    </p>
  </div>
</a>

  <footer class="site-footer">
  <div class="inner">
    <section class="copyright">A developer&rsquo;s thoughts on life, code, and the pursuit of happiness.</section>
  </div>
</footer>

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="http://bethqiang.com/js/index.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-85574806-1', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>